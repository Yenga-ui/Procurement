@{
    ViewBag.Title = "Form Builder";
}
<link type="text/css" rel="stylesheet" href="~/assets/css/form.builder.css" />
<link type="text/css" rel="stylesheet" href="~/assets/fontawesome/css/font-awesome.min.css" />
<style>
    .btn.btn-primary:hover:not(.btn-text):not(:disabled):not(.disabled), .btn.btn-primary:focus:not(.btn-text), .btn.btn-primary.focus:not(.btn-text) {
        color: #fff;
        background-color: #2780e3;
        border-color: #2780e3;
        border-radius: 0;
    }

    .accordion input {
        border-radius: 0 !important;
        border: none !important;
        /*border-bottom: 1px solid grey !important;*/
    }

    textarea {
        border-radius: 0 !important;
    }

</style>

<div class="container">
    <div data-repeater-item="" class="form-group row p-3">
        <div class="col-md-6" id="bd">

            <partial name="_Accordion.cshtml" />

            <!-- TinyMCE-->
            @*<partial name="_Editor.cshtml" />*@
        </div>
        <div class="col-md-6">
            <div class="card card-custom gutter-b">
                <div class="card-header">
                    <div class="card-title">
                        <h3 class="card-label text-muted">Sections</h3>
                    </div>
                </div>
                <div class="card-body">
                    <table class="table table-hover d-none" id="sections">
                        <thead>
                            <tr>
                             
                                <th>Title</th>
                                <th>Description</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts{
@*<script src="~/assets/js/pages/crud/forms/widgets/form-repeater.js"></script>
*@<script src="~/assets/plugins/custom/tinymce/tinymce.bundle.js"></script>
<script src="~/assets/js/pages/crud/forms/editors/tinymce.js"></script>

<script>
    $(document).ready(function(){


        $("#btnClone").on('click',function(e){

            $("#cdAdd").clone().appendTo("#bd");
        });

        
        $("#delete").on('click',function(e){
            $(this).parent().remove();


        });
            
        
        $("#saveSection").on('click', function(e){

            let formData = new FormData($("#sectionDataform")[0]);
            let payload = {
                Title: $("#Title").val(),
                Description: $("#Description").val(),
                SupportingDocumentation: $("#SupportingDocumentation").val(),
                TextResponse: $("#TextResponse").val()
            };

            /*for(var pair of formData.entries()) {
                payload[pair[0]]= pair[1];
            }*/



            console.log("payload", payload)
            console.log(JSON.stringify(payload))

            let settings = {
                url: "/tender-section/create",
                method: "POST",
                dataType: "json",
                data: JSON.stringify(payload),
                contentType: 'application/json'
            }
            var i=1;
   
            $.ajax(settings).done(function(response){
                setTimeout(function(){
                   if(response.success){
                        $("#sections").removeClass('d-none');
                        swal.fire('Tender Submission !', response, 'success');

                         let data = response.payload;

                          let row = `<tr>
                           
                            
                            <td>${data.title}</td>
                            <td>${data.description}</td>
                            <td><button class="btn btn sm btn-primary">Define Section</button> </td>
                           
                          </tr>`;

                            $('#sections > tbody').append(row);
                       $('#sectionData').trigger("reset");

                   }else{
                        swal.fire('Oops !', message, 'error');
                   }
               },300);
            })
            .fail(function(xhr){
               swal.fire('Oops !',"Failed to process request", 'error');
           });
        })
    })

</script>
}